@model IEnumerable<WebsiteQLBanDongHo.WebsiteQLBanDongHoDomain.DataContext.DONHANG>

<div class="table-responsive">
    <table class="table table-hover table-striped table-sm" id="dataTable" width="100%" cellspacing="0">
        <thead class="bg-light">
            <tr>
                <th class="text-center">Mã ĐH</th>
                <th>Khách hàng</th>
                <th>Ngày đặt</th>
                <th class="text-right">Tổng tiền</th>
                <th>Trạng thái</th>
                <th class="text-center" style="width: 150px;">Thao tác</th>
            </tr>
        </thead>
        <tbody>
            @if (Model != null && Model.Any())
            {
                foreach (var item in Model)
                {
                    if (item.MADH <= 0)
                    {
                        continue;
                    }
                    string statusClass = item.TRANGTHAI == "đã hủy" ? "danger" : item.TRANGTHAI == "đã giao" ? "success" : item.TRANGTHAI == "đang giao hàng" ? "info" : "warning";
                    <tr>
                        <td class="text-center text-primary font-weight-bold">#@item.MADH</td>
                        <td>@(item.KHACHHANG != null ? item.KHACHHANG.TENKH : "Khách vãng lai")</td>
                        <td>
                            @(item.NGAYDAT?.ToString("dd/MM/yyyy"))
                        </td>
                        <td class="text-right font-weight-bold text-success">@String.Format("{0:N0} VNĐ", item.TONGTIEN)</td>
                        <td>
                            <span class="badge badge-pill badge-@statusClass p-2 text-uppercase">
                                @item.TRANGTHAI
                            </span>
                        </td>
                        <td class="text-center">
                            <button class="btn btn-sm btn-outline-info btn-view-detail mr-1" data-mahd="@item.MADH" title="Xem/Sửa chi tiết">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger btn-delete-order" data-mahd="@item.MADH" title="Xóa đơn hàng">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="6" class="text-center text-muted p-4">Không tìm thấy đơn hàng nào.</td>
                </tr>
            }
        </tbody>
    </table>
</div>

<div class="d-flex justify-content-end mt-3 mb-3">
    @{
        int currentPage = ViewBag.CurrentPage ?? 1;
        int totalPages = ViewBag.TotalPages ?? 1;
        string searchKeyword = ViewBag.SearchKeyword;
    }

    <nav aria-label="Page navigation">
        <ul class="pagination pagination-sm">
            <li class="page-item @(currentPage <= 1 ? "disabled" : "")">
                <a class="page-link page-link-ajax" href="#" data-page="@(currentPage - 1)">Trước</a>
            </li>

            @for (int i = 1; i <= totalPages; i++)
            {
                <li class="page-item @(i == currentPage ? "active" : "")">
                    <a class="page-link page-link-ajax" href="#" data-page="@i">@i</a>
                </li>
            }

            <li class="page-item @(currentPage >= totalPages ? "disabled" : "")">
                <a class="page-link page-link-ajax" href="#" data-page="@(currentPage + 1)">Sau</a>
            </li>
        </ul>
    </nav>
</div>