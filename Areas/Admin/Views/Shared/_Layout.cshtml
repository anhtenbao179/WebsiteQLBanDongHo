@using WebsiteQLBanDongHo.Common

@{
    var userSession = (UserLogin)Session[CommonConstands.ADMIN_SESSION];
    string userName = userSession?.UserName ?? "Khách";
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUẢN LÝ ĐỒNG HỒ CAO CẤP - ADMIN</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link href="~/Areas/Admin/Content/css/admin-modern.css" rel="stylesheet" />

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    @RenderSection("styles", required: false)
</head>
<body>
    <div class="admin-wrapper d-flex">
        <nav id="sidebar" class="bg-dark text-light">
            <div class="sidebar-header text-center py-4 border-bottom border-secondary">
                <h5 class="text-gold fw-bold mb-0">WATCH LUXURY ADMIN</h5>
            </div>
            <ul class="list-unstyled sidebar-menu px-2 mt-3">
                <li>
                    <a href="~/Admin/Home/Index" class="d-flex align-items-center py-2 px-3">
                        <i class="fa-solid fa-gauge me-2 text-gold"></i> Bảng điều khiển
                    </a>
                </li>
                <li class="has-submenu">
                    <a href="#typeSubmenu" data-bs-toggle="collapse" class="d-flex justify-content-between align-items-center py-2 px-3">
                        <span><i class="fa-solid fa-layer-group me-2 text-gold"></i> Loại</span>
                        <i class="fa fa-angle-down rotate-icon"></i>
                    </a>
                    <ul class="collapse list-unstyled ps-4" id="typeSubmenu">
                        <li><a href="~/Admin/ProductBrand/Index" class="py-1 d-block">Thương hiệu sản phẩm</a></li>
                        <li><a href="~/Admin/ProductCategory/Index" class="py-1 d-block">Danh mục sản phẩm</a></li>
                        <li><a href="~/Admin/Promotion/Index" class="py-1 d-block">Khuyến mãi</a></li>
                        <li><a href="~/Admin/PromotionDetail/Index" class="py-1 d-block">Chi tiết khuyến mãi</a></li>
                    </ul>
                </li>
                <li>
                    <a href="~/Admin/Product/Index" class="d-flex align-items-center py-2 px-3">
                        <i class="fa-solid fa-box me-2 text-gold"></i> Sản phẩm
                    </a>
                </li>
                <li>
                    <a href="~/Admin/Order/Index" class="d-flex align-items-center py-2 px-3">
                        <i class="fa-solid fa-cart-shopping me-2 text-gold"></i> Đơn đặt hàng
                    </a>
                </li>
                <li>
                    <a href="~/Admin/Customer/Index" class="d-flex align-items-center py-2 px-3">
                        <i class="fa-solid fa-users me-2 text-gold"></i> Khách hàng
                    </a>
                </li>
                <li>
                    <a href="~/Admin/User/Index" class="d-flex align-items-center py-2 px-3">
                        <i class="fa-solid fa-user-gear me-2 text-gold"></i> Tài khoản
                    </a>
                </li>
                <li>
                    <a href="~/Admin/Report/SoldReport" class="d-flex align-items-center py-2 px-3">
                        <i class="fa-solid fa-chart-line me-2 text-gold"></i> Đã bán ra
                    </a>
                </li>
                <li>
                    <a href="~/Admin/Comment/Index" class="d-flex align-items-center py-2 px-3">
                        <i class="fa-solid fa-comments me-2 text-gold"></i> Phản hồi
                    </a>
                </li>
                <li>
                    <a href="~/Home/Index" target="_blank" class="d-flex align-items-center py-2 px-3">
                        <i class="fa-solid fa-house me-2 text-gold"></i> Xem trang chủ
                    </a>
                </li>
            </ul>
        </nav>
        <div id="content" class="flex-grow-1 bg-light">
            <nav class="navbar navbar-expand-lg navbar-dark bg-black shadow-sm px-3">
                <div class="d-flex align-items-center">
                    <button id="sidebarToggle" class="btn btn-sm text-gold me-3">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                    <span class="navbar-brand mb-0 h5 fw-bold text-gold">Quản lý hệ thống</span>
                </div>
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-light d-flex align-items-center" href="#" id="userDropdown" data-bs-toggle="dropdown">
                            <i class="fa-solid fa-user me-1"></i>
                            <span>@(userSession != null ? userSession.UserName : "Admin")</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end shadow-sm">
                            <li><a class="dropdown-item" href="~/Admin/Account/Index"><i class="fa-solid fa-user me-2"></i>Thông tin người dùng</a></li>
                            <li><a class="dropdown-item" href="~/Admin/Account/Settings"><i class="fa-solid fa-gear me-2"></i>Cài đặt</a></li>
                            <li><hr class="dropdown-divider" /></li>
                            <li><a class="dropdown-item text-danger" href="~/Admin/Home/Logout"><i class="fa-solid fa-right-from-bracket me-2"></i>Đăng xuất</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
            <main class="p-4">
                @RenderBody()
            </main>
        </div>
    </div>

    <script src="~/Areas/Admin/Content/js/admin-modern.js"></script>
    <script>
        $(document).ready(function () {
            var currentPath = window.location.pathname.toLowerCase();
            var currentUrlNormalized = currentPath.replace(/\/index$/, '').replace(/\/$/, '');
            if (currentUrlNormalized === '/admin') {
                currentUrlNormalized = '/admin/home';
            }

            $('.sidebar-menu li').removeClass('active');
            $('.sidebar-menu ul.collapse').removeClass('show');
            $('.sidebar-menu a i').removeClass('text-dark').addClass('text-gold');
            $('.sidebar-menu a').each(function () {
                var $this = $(this);
                var linkHref = $this.attr('href') ? $this.attr('href').toLowerCase() : '';
                var linkUrlNormalized = linkHref.replace(/^~/, '').replace(/\/index$/, '').replace(/\/$/, '');
                if (currentUrlNormalized === linkUrlNormalized) {
                    var $activeListItem = $this.closest('li');
                    $activeListItem.addClass('active');
                    if (!$activeListItem.parent('ul.collapse').length) {
                        $this.find('i').removeClass('text-gold').addClass('text-dark');
                    }

                    var $parentUl = $this.closest('ul.collapse');
                    if ($parentUl.length) {
                        $parentUl.addClass('show');
                        var $parentLi = $parentUl.closest('li.has-submenu');
                        $parentLi.addClass('active');
                        $parentLi.find('> a i.fa-layer-group').removeClass('text-gold').addClass('text-dark');
                        $parentUl.prev('a[data-bs-toggle="collapse"]').find('.rotate-icon').addClass('rotate');
                    }
                    return false;
                }
            });
        });
    </script>
    @RenderSection("scripts", required: false)
</body>
</html>